# Git讲义     
## Git是什么   
Git是分布式版本控制系统。版本控制是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的系统。 而在分布式中，客户端并不只提取最新版本的文件快照， 而是把代码仓库完整地镜像下来，包括完整的历史记录。相对地，在集中式中，有一个单一的集中管理的服务器，保存所有文件的修订版本，而协同工作的人们都通过客户端连到这台服务器，取出最新的文件或者提交更新。     
## Git简史   
Linux 内核开源项目有着为数众多的参与者。 绝大多数的 Linux 内核维护工作都花在了提交补丁和保存归档的繁琐事务上（1991－2002年间）。 到 2002 年，整个项目组开始启用一个专有的分布式版本控制系统 BitKeeper 来管理和维护代码。  
到了 2005 年，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他们收回了 Linux 内核社区免费使用 BitKeeper 的权力。 这就迫使 Linux 开源社区开发出自己的版本系统。  
## Git数据库  
Git是一个内容寻址文件系统，这意味着其核心部分是一个简单的**键值对数据库（key-value data store）** ，在数学上是**默克尔树形成的有向无环图** ，您可以向 Git 仓库中插入任意文件，它会返回一个唯一的键，通过该键可以在任意时刻再次取回该文件。该键基于文件的内容或目录结构，计算出来是40位的SHA1校验值。而文件存储在.git/objects目录下，以SHA1校验值前两位命名的文件夹中。而文件被重新命名为SHA1校验值的后38位。  
对象的结构通常如下：   
- tag，表示该对象的类型，即blob
- size，表示对象内容的长度
- 对象内容。

在数据库中的对象可以分为以下种类：  
- **数据对象** ，保存着文件的内容以及相关数据。
- **树对象** ，解决文件名保存和文件组织问题。该对象表示了一个目录结构。其对象内容表示一个列表，列表中的每个项表示一个文件或子文件夹，其结构如下
    - mode，表示权限和类型
    - sha1，表示对象SHA1校验值
    - file name，表示对象名
- **提交对象** ，记录版本间的时序关系和版本注释。提交对象的对象内容包含一个指向这个树对象（项目根目录）的指针，还包含了作者的姓名和邮箱、提交时输入的信息、任意个指向它的父对象的指针。  
  
Git数据库存储的是文件的快照，而不是文件的变更记录。在一定程度上会浪费空间，但是Git有**垃圾回收机制** ，以清除无用的对象。同时会把相似的对象打包压缩以节约空间。  

## Git引用   
**Git的引用（references）** 是指向Git对象的指针，其存储在.git/refs目录下。分支、标签的实现是基于Git引用的。  
## Git工作区、暂存区、仓库   
- **工作区（working tree）** ，对项目的某个版本**独立提取**出来的内容。这些从Git仓库的数据库中提取出来的文件，放在本地磁盘上供您使用或修改。
- **暂存区（index、cache）** ，该区仅仅是一个文件（.git/index），保存了下次将要提交的文件列表信息。  
- **Git仓库（repository）** ，是 Git 用来保存项目的相关数据和Git数据库的地方。  
## Git文件状态  
在Git中，您的文件可能处于以下状态之一：
- **已提交（committed）** ，表示文件已安全地保存在Git仓库的数据库中。
- **已修改（modified）** ，自上次提交后，您编辑了某些文件，则Git将这些文件标更改为已修改的状态，但此时并未添加到Git仓库中。  
- **已暂存（staged）** ，表示对已修改的文件做了标记，在下次向Git仓库提交中，包含这些已暂存的文件。   
  
在工作目录中，您的文件可能以下状态之一： 
- **已跟踪** ，被纳入到Git版本控制的文件。
- **未跟踪** ，未被纳入到Git版本控制的文件。  
## 参考    
https://git-scm.com/book/zh/v2    
https://zhuanlan.zhihu.com/p/71577255   
https://zhuanlan.zhihu.com/p/45510461   